document.addEventListener('DOMContentLoaded',()=>{document.querySelectorAll('.buybox[data-asin]').forEach(async el=>{const asin=el.getAttribute('data-asin');try{const r=await fetch(`/api/price?asin=${encodeURIComponent(asin)}`);if(!r.ok)return;const j=await r.json();const node=el.closest('tr')?.querySelector(`#price-${asin}`)||el.querySelector(`#price-${asin}`);if(node)node.textContent=(j.price||'Consultar')+(j.availability?` - ${j.availability}`:'');}catch(e){}});});